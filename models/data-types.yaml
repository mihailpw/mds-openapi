title: MDS common data types
description: Shared schema definitions used across MDS OpenAPI.
type: object

x-stoplight:
  id: vfaag0vpz3odt

properties:
  area_type:
    type: string
    description: The type of a service area.
    enum:
      - unrestricted
      - restricted
      - preferred_pick_up
      - preferred_drop_off

  currency:
    type:
      - string
      - "null"
    pattern: ^[A-Z]{3}$
    default: USD
    description:
      An ISO 4217 Alphabetic Currency Code representing currency of the
      payee. If null, USD cents is implied.
    examples:
      - USD
      - EUR
      - GBP

  day:
    type: string
    description: A day of the week.
    enum:
      - sun
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat

  days:
    type: array
    description: An array of days of the week.
    items:
      $ref: "#/properties/day"
    uniqueItems: true

  device:
    type: object
    required:
      - device_id
    description: Common properties for all device-related objects.
    properties:
      device_id:
        $ref: "#/properties/uuid"
        description: A unique device ID in UUID format, should match this device in Provider.
    allOf:
      - $ref: "#/properties/provider"

  event_type:
    type: string
    description: Events are possible transitions between vehicle states.
    enum:
      - agency_drop_off
      - agency_pick_up
      - battery_charged
      - battery_low
      - changed_geographies
      - charging_start
      - charging_end
      - comms_lost
      - comms_restored
      - compliance_pick_up
      - customer_cancellation
      - decommissioned
      - driver_cancellation
      - fueling_start
      - fueling_end
      - located
      - maintenance_pick_up
      - maintenance_end
      - not_located
      - off_hours
      - on_hours
      - order_drop_off
      - order_pick_up
      - provider_cancellation
      - provider_drop_off
      - rebalance_pick_up
      - remote_start
      - remote_end
      - reservation_cancel
      - reservation_start
      - reservation_stop
      - system_resume
      - system_suspend
      - trip_cancel
      - trip_end
      - trip_enter_jurisdiction
      - trip_leave_jurisdiction
      - trip_start
      - trip_pause
      - trip_resume
      - unspecified

  event_types:
    type: array
    description: Array of events indicating a change to a vehicle's state.
    uniqueItems: true
    minItems: 1
    items:
      $ref: "#/properties/event_type"

  gps_data:
    type: object
    required:
      - lat
      - lng
    properties:
      lat:
        type: number
        description: Latitude coordinate.
        minimum: -90
        maximum: 90
      lng:
        type: number
        description: Longitude coordinate.
        minimum: -180
        maximum: 180
      altitude:
        type: number
        description: Altitude above mean sea level in meters.
      heading:
        type: number
        description: Degrees - clockwise starting at 0 degrees at true North.
      speed:
        type: number
        description: Estimated speed in meters / sec as reported by the GPS chipset.
      horizontal_accuracy:
        type: number
        description: Horizontal accuracy in meters.
      vertical_accuracy:
        type: number
        description: Vertical accuracy in meters.
      satellites:
        $ref: "#/properties/integer_positive"
        description: Number of GPS or GNSS satellites.

  integer_positive:
    type: integer
    minimum: 0
    description: An integer greater than or equal to 0.

  iso_date:
    type: string
    description: Date expressed as ISO 8601 `YYYY-MM-DD`; valid for dates in 1970 and later.
    pattern: (19[789]\d|[2-9]\d{3})-(0[1-9]|1[02])-([12]\d|0[1-9]|3[01])
    examples:
      - "2023-12-31"
      - "2024-01-01"

  iso_dayhour:
    type: string
    description: An ISO 8601 extended datetime representing an UTC hour between 00 and 23 `YYYY-MM-DDTHH`; valid for dates in 1970 and later.
    pattern: (19[789]\d|[2-9]\d{3})-(0[1-9]|1[02])-([12]\d|0[1-9]|3[01])T([0-2][0-3]|[01]\d)
    examples:
      - "2023-12-31T23"
      - "2024-01-01T01"

  iso_time:
    type: string
    description: Time-of-day expressed as ISO 8601 `hh:mm:ss`.
    pattern: ([0-2][0-3]|[01]\d):[0-5]\d:[0-5]\d
    examples:
      - "23:59:59"
      - "00:00:01"

  minimum_year:
    type: integer
    minimum: 1970
    description: Represents a minimum for fields that capture a year as an integer. Derived from Unix timestamp 0.

  propulsion_type:
    type: string
    description: The allowed types of propulsion in MDS. Based off of `propulsion_type` in [GBFS vehicle_types](https://github.com/MobilityData/gbfs/blob/master/gbfs.md#vehicle_typesjson)
    enum:
      - human
      - electric_assist
      - electric
      - combustion
      - combustion_diesel
      - hybrid
      - hydrogen_fuel_cell
      - plug_in_hybrid

  propulsion_types:
    type: array
    description: Array of propulsion types, allowing multiple values.
    items:
      $ref: "#/properties/propulsion_type"
    uniqueItems: true

  provider:
    type: object
    description: Common properties for all provider-related objects.
    required:
      - provider_id
    properties:
      provider_id:
        $ref: "#/properties/uuid"
        description: A UUID for the Provider, unique within MDS. See MDS [provider list](https://github.com/openmobilityfoundation/mobility-data-specification/blob/main/providers.csv).
      data_provider_id:
        $ref: "#/properties/uuid"
        description: If different than `provider_id`, a UUID for the data solution provider managing the data feed in this endpoint.

  rental_methods:
    type: array
    description: Payment methods accepted at this Stop. From GBFS Station Information.
    items:
      enum:
        - KEY
        - CREDITCARD
        - PAYPASS
        - APPLEPAY
        - ANDROIDPAY
        - TRANSITCARD
        - ACCOUNTNUMBER
        - PHONE
    uniqueItems: true

  stop:
    type: object
    description: The common schema elements for a Stop in MDS.
    required:
      - stop_id
      - name
      - last_reported
      - location
      - status
      - capacity
      - num_vehicles_available
      - num_vehicles_disabled
    properties:
      stop_id:
        $ref: "#/properties/uuid"
        description: UUID for the Stop.
      name:
        $ref: "#/properties/string"
        description: Name of the Stop.
      last_reported:
        $ref: "#/properties/timestamp"
        description: Date/Time of the last status update for this Stop.
      location:
        $ref: "#/properties/gps_data"
        description: Location of the stop.
      status:
        $ref: "#/properties/stop_status"
        description: The status of the Stop.
      capacity:
        $ref: "#/properties/vehicle_type_counts"
        description: Number of total places per vehicle_type.
      num_vehicles_available:
        $ref: "#/properties/vehicle_type_counts"
        description: Number of available vehicles per vehicle_type.
      num_vehicles_disabled:
        $ref: "#/properties/vehicle_type_counts"
        description: Number of non_operational/reserved vehicles per vehicle_type.
      provider_id:
        $ref: "#/properties/uuid"
        description:
          UUID for the Provider managing this Stop. Null/undefined if managed
          by an Agency.
      geography_id:
        $ref: "#/properties/uuid"
        description: UUID for the Stop.
      region_id:
        $ref: "#/properties/string"
        description:
          ID of the region where the Stop is located. See GBFS Station
          Information.
      short_name:
        $ref: "#/properties/string"
        description: Abbreviated Stop name.
      address:
        $ref: "#/properties/string"
        description: Postal address (useful for directions).
      post_code:
        $ref: "#/properties/string"
        description: Postal code (e.g. 10036).
      cross_street:
        $ref: "#/properties/string"
        description: Cross street of where Stop is located.
      num_places_available:
        $ref: "#/properties/vehicle_type_counts"
        description: Number of places free to be populated per vehicle_type.
      num_places_disabled:
        $ref: "#/properties/vehicle_type_counts"
        description: Number of places disabled an unable to accept vehicles per vehicle_type.
      parent_stop:
        $ref: "#/properties/uuid"
        description: Describe a basic hierarchy of Stops (e.g. a Stop inside a greater Stop).
      devices:
        $ref: "#/properties/uuid_array"
        description: List of device_id for vehicles currently at this Stop.

  stop_status:
    type: object
    description: Status object for a Stop in MDS.
    required:
      - is_installed
      - is_renting
      - is_returning
    properties:
      is_installed:
        type: boolean
      is_renting:
        type: boolean
      is_returning:
        type: boolean

  string:
    type: string
    description: A length-limited string type.
    maxLength: 255
    examples:
      - ABC123
    pattern: ^(.*)$

  timestamp:
    type: number
    description: Integer milliseconds since Unix epoch.
    multipleOf: 1
    minimum: 1514764800000

  trip_id_reference:
    description: Conditionally require a trip_id reference.
    anyOf:
      - not:
          properties:
            event_types:
              contains:
                enum:
                  - trip_cancel
                  - trip_end
                  - trip_enter_jurisdiction
                  - trip_leave_jurisdiction
                  - trip_start
      - required:
          - trip_id

  ttl:
    type: integer
    description: Integer milliseconds until next data update (0 if the data is.
      always refreshed)
    minimum: 0
    maximum: 300000

  uuid:
    type: string
    description: A UUID used to uniquely identity an object.
    examples:
      - 3c9604d6-b5ee-11e8-96f8-529269fb1459
    pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$

  uuid_array:
    type: array
    description: Array of UUID.
    minItems: 1
    uniqueItems: true
    items:
      $ref: "#/properties/uuid"

  vehicle_state:
    type: string
    description: The state of a vehicle.
    enum:
      - removed
      - available
      - non_operational
      - reserved
      - on_trip
      - stopped
      - non_contactable
      - missing
      - elsewhere

  vehicle_state_transitions:
    description: valid vehicle_state and vehicle_events combinations.
    oneOf:
      - properties:
          vehicle_state:
            const: available
          vehicle_events:
            contains:
              enum:
                - agency_drop_off
                - battery_charged
                - comms_restored
                - located
                - maintenance
                - on_hours
                - provider_drop_off
                - reservation_cancel
                - system_resume
                - trip_cancel
                - trip_end
                - unspecified
      - properties:
          vehicle_state:
            const: elsewhere
          vehicle_events:
            contains:
              enum:
                - comms_restored
                - located
                - trip_leave_jurisdiction
                - unspecified
      - properties:
          vehicle_state:
            const: non_operational
          vehicle_events:
            contains:
              enum:
                - battery_low
                - comms_restored
                - located
                - maintenance
                - off_hours
                - system_suspend
                - unspecified
      - properties:
          vehicle_state:
            const: on_trip
          vehicle_events:
            contains:
              enum:
                - comms_restored
                - located
                - trip_enter_jurisdiction
                - trip_start
                - unspecified
      - properties:
          vehicle_state:
            const: removed
          vehicle_events:
            contains:
              enum:
                - agency_pick_up
                - comms_restored
                - compliance_pick_up
                - decommissioned
                - located
                - maintenance_pick_up
                - rebalance_pick_up
                - unspecified
      - properties:
          vehicle_state:
            const: reserved
          vehicle_events:
            contains:
              enum:
                - comms_restored
                - located
                - reservation_start
                - unspecified
      - properties:
          vehicle_state:
            const: unknown
          vehicle_events:
            contains:
              enum:
                - comms_lost
                - missing
                - unspecified

  vehicle_type:
    type: string
    description: The allowed types of of vehicles in MDS. Based off of `form_factor` in [GBFS vehicle_types](https://github.com/MobilityData/gbfs/blob/master/gbfs.md#vehicle_typesjson), with some additional to support MDS modes.
    enum:
      - bicycle
      - bus
      - cargo_bicycle
      - car
      - delivery_robot
      - moped
      - motorcycle
      - scooter_standing
      - scooter_seated
      - truck
      - other

  vehicle_types:
    type: array
    description: Array of vehicle types.
    items:
      $ref: "#/properties/vehicle_type"
    uniqueItems: true

  vehicle_type_counts:
    type: object
    properties:
      bicycle:
        type: integer
        minimum: 0
      cargo_bicycle:
        type: integer
        minimum: 0
      car:
        type: integer
        minimum: 0
      scooter:
        type: integer
        minimum: 0
      moped:
        type: integer
        minimum: 0
      other:
        type: integer
        minimum: 0
    additionalProperties: false
